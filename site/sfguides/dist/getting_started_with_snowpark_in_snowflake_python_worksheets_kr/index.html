
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Snowflake Python 워크시트에서 Snowpark 시작하기</title>

  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5Q8R2G');</script>
  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-08H27EW14N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-08H27EW14N');
</script>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Q8R2G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <google-codelab-analytics gaid="UA-41491190-9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="getting_started_with_snowpark_in_snowflake_python_worksheets_kr"
                  title="Snowflake Python 워크시트에서 Snowpark 시작하기"
                  environment="web"
                  feedback-link="https://github.com/Snowflake-Labs/sfguides/issues">
    
      <google-codelab-step label="개요" duration="5">
        <p>이 가이드를 완료하면 Snowflake UI 내에서 Snowpark for Python을 사용해 볼 수 있습니다. 결과적으로 Snowflake Python 워크시트에서 Snowpark를 사용하여 핵심 데이터 엔지니어링 작업을 수행하는 방법을 더 잘 이해하게 됩니다.</p>
<h2 is-upgraded>Snowpark란 무엇일까요?</h2>
<p>Python, Java 및 Scala를 비롯한 비 SQL 코드를 안전하게 배포하고 처리하는 Snowflake의 라이브러리 및 런타임 세트입니다.</p>
<p><strong>익숙한 클라이언트 측 라이브러리</strong> - Snowpark는 심층적으로 통합된 DataFrame 스타일의 프로그래밍 및 OSS 호환 가능 API를 데이터 실무자가 선호하는 언어로 가져옵니다. 또한, 여기에는 더 효율적인 ML 모델링(공개 미리 보기) 및 ML 작업(비공개 미리 보기)을 위한 Snowpark ML API가 포함됩니다.</p>
<p><strong>유연한 런타임 구조</strong> - Snowpark는 사용자가 사용자 정의 로직을 가져와 실행할 수 있도록 하는 유연한 런타임 구조를 제공합니다. 개발자는 사용자 정의 함수 및 저장 프로시저를 사용하여 원활하게 데이터 파이프라인, ML 모델 및 데이터 애플리케이션을 구축할 수 있습니다.</p>
<p><a href="https://www.snowflake.com/snowpark/" target="_blank">Snowpark</a>에 대해 자세히 알아보십시오.</p>
<p class="image-container"><img alt="Snowpark" src="img/9f7d4fd72f4d8a3f.png"></p>
<h2 is-upgraded>Python 워크시트란 무엇일까요?</h2>
<p>Python 워크시트는 Snowpark를 더 빨리 시작할 수 있도록 돕는 Snowsight에 있는 새로운 유형의 워크시트입니다. 사용자는 추가 IDE(개발 UI)를 스핀업하거나, 설정하거나, Python을 위해 유지하지 않고 Snowflake 내부에서 바로 데이터 파이프라인, ML 모델 및 애플리케이션을 개발할 수 있습니다. 또한, 이러한 워크시트는 Snowpark 애플리케이션을 예약하기 위해 프로시저로 변환할 수 있습니다.</p>
<h2 is-upgraded>학습할 내용</h2>
<ul>
<li>Snowflake 테이블에서 Snowpark DataFrame으로 데이터 로드하기</li>
<li>Snowpark DataFrame에서 탐색적 데이터 분석 수행하기</li>
<li>Snowpark DataFrame을 사용하여 여러 테이블의 데이터를 피벗 및 결합하기</li>
<li>변환된 데이터를 Snowflake 테이블에 저장하기</li>
<li>Python 워크시트를 저장 프로시저로 배포하기</li>
</ul>
<h2 is-upgraded>구축할 것</h2>
<p>다운스트림 분석 및 애플리케이션에 사용할 수 있도록 준비된 데이터 세트 예: 머신러닝 모델 훈련</p>


      </google-codelab-step>
    
      <google-codelab-step label="시작하기" duration="10">
        <h2 is-upgraded>Snowflake 평가판 계정 생성</h2>
<p>이 <a href="https://signup.snowflake.com/?lab=getStartedWithSnowparkInPythonWorksheets" target="_blank">링크</a>(<strong>Snowflake Python 워크시트에서 Snowpark 시작하기</strong>라는 제목의 평가판 설정 페이지와 연결되어 있음)를 사용하여 30일 무료 평가판을 위해 등록하십시오. 자신과 가장 가까운 리전을 권장합니다. 가장 인기 있는 에디션인 엔터프라이즈를 권장하지만, 이 랩에서는 모든 에디션을 사용할 수 있습니다.</p>
<h2 is-upgraded>로그인 및 랩 설정</h2>
<p>Snowflake 계정에 로그인합니다. 이 랩에 액세스하고 샘플 데이터 및 코드를 설정하려면 다음 링크를 클릭해야 합니다.</p>
<aside class="special"><p> 중요: 아래에서 설명하는 랩 설정을 계속하려면 ACCOUNTADMIN 역할을 보유하고 있어야 합니다. 참고: 새로운 평가판 계정을 생성한 경우, 자동으로 ACCOUNTADMIN 역할을 보유하게 됩니다.</p>
</aside>
<p><a href="https://app.snowflake.com/resources/labs/getStartedWithSnowparkInPythonWorksheets" target="_blank"><paper-button class="colored" raised>랩 환경 설정</paper-button></a></p>
<p>위 버튼은 <strong>Snowflake Python 워크시트에서 Snowpark 시작하기</strong> 라는 제목의 평가판 페이지와 연결되어 있습니다. 이 페이지는 <strong>Setup Lab</strong>을 클릭하도록 안내합니다. 이를 클릭하면 1분 이내에 설명이 포함된 데이터 및 샘플 Python 코드를 비롯한 설정이 제공됩니다.</p>
<p>==================================================================================================</p>
<p class="image-container"><img alt="Deploy" src="img/243c2ac72aba4fe.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Snowflake 테이블에서 Snowpark DataFrame으로 데이터 로드" duration="3">
        <p>우선, Snowpark Python 라이브러리를 가져오겠습니다.</p>
<pre><code language="language-python" class="language-python"># Import Snowpark for Python
import snowflake.snowpark as snowpark
</code></pre>
<h2 is-upgraded>집계된 캠페인 지출 및 수익 데이터 로드</h2>
<p>이 캠페인 지출 테이블에는 일일 지출을 보여주기 위해 여러 디지털 광고 채널(예: 검색 엔진, 소셜 미디어, 이메일 및 동영상)에 걸쳐 집계된 광고 클릭 데이터가 포함되어 있습니다. 수익 테이블에는 10년 동안의 수익 데이터가 포함되어 있습니다.</p>
<p>이 사례에서는 <strong><em>campaign_spend</em></strong> 및 <strong><em>monthly_revenue</em></strong> 테이블에서 데이터를 로드하기 위해 다음 코드를 사용하겠습니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend = session.table(&#39;campaign_spend&#39;)
snow_df_revenue = session.table(&#39;monthly_revenue&#39;)
</code></pre>
<p>또한, 데이터를 Snowpark DataFrame으로 로드하는 다른 방법은 다음과 같습니다.</p>
<ul>
<li>session.sql(&#34;select col1, col2... from tableName&#34;)</li>
<li>session.read.options({&#34;field_delimiter&#34;: &#34;,&#34;, &#34;skip_header&#34;: 1}).schema(user_schema).csv(&#34;@mystage/testCSV.csv&#34;)</li>
<li>session.read.parquet(&#34;@stageName/path/to/file&#34;)</li>
<li>session.create_dataframe([1,2,3], schema=[&#34;col1&#34;])</li>
</ul>
<p>팁: <a href="https://docs.snowflake.com/ko/developer-guide/snowpark/reference/python/dataframe.html" target="_blank">Snowpark DataFrame</a>에 대해 자세히 알아보십시오.</p>


      </google-codelab-step>
    
      <google-codelab-step label="데이터 변환" duration="10">
        <p>이 섹션에서는 집계 및 2개의 DataFrame 결합을 비롯한 변환 세트를 수행하겠습니다.</p>
<p>우선, 필요하게 될 모든 함수를 가져오겠습니다.</p>
<pre><code language="language-python" class="language-python">from snowflake.snowpark.functions import month,year,col,sum
</code></pre>
<h2 is-upgraded>모든 채널의 연간 및 월별 총지출</h2>
<p><strong><em>group_by()</em></strong> 및 <strong><em>agg()</em></strong> Snowpark DataFrame 함수를 사용하여 <strong>채널당 연간 및 월별 총비용</strong>을 확인할 수 있도록 이 데이터를 변환하겠습니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend_per_channel = snow_df_spend.group_by(year(&#39;DATE&#39;), month(&#39;DATE&#39;),&#39;CHANNEL&#39;).agg(sum(&#39;TOTAL_COST&#39;).as_(&#39;TOTAL_COST&#39;)).with_column_renamed(&#39;&#34;YEAR(DATE)&#34;&#39;,&#34;YEAR&#34;).with_column_renamed(&#39;&#34;MONTH(DATE)&#34;&#39;,&#34;MONTH&#34;).sort(&#39;YEAR&#39;,&#39;MONTH&#39;)
</code></pre>
<p>팁: 전체 <a href="https://docs.snowflake.com/ko/developer-guide/snowpark/reference/python/functions.html" target="_blank">함수</a> 목록을 확인하십시오.</p>
<p>이 변환 결과를 확인하기 위해 출력을 <strong>Output</strong> 탭에 출력하는 Snowpark DataFrame의 <strong><em>show()</em></strong> 함수를 사용할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">print(&#34;Total Spend per Year and Month For All Channels&#34;)
snow_df_spend_per_channel.show()
</code></pre>
<h2 is-upgraded>모든 채널에 걸친 총지출</h2>
<p>각 행이 <strong><em>pivot()</em></strong> 및 <strong><em>sum()</em></strong> Snowpark DataFrame 함수를 사용하여 모든 채널에 걸쳐 연간 및 월별 총비용을 나타내도록 캠페인 지출 데이터를 추가적으로 변환하겠습니다.</p>
<p>이 변환을 수행하면 수익 테이블과 결합할 수 있습니다. 이렇게 하면 모델 훈련을 위해 단일 테이블에 입력 피처와 대상 변수를 보유하게 됩니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend_per_month = snow_df_spend_per_channel.pivot(&#39;CHANNEL&#39;,[&#39;search_engine&#39;,&#39;social_media&#39;,&#39;video&#39;,&#39;email&#39;]).sum(&#39;TOTAL_COST&#39;).sort(&#39;YEAR&#39;,&#39;MONTH&#39;)
snow_df_spend_per_month = snow_df_spend_per_month.select(
    col(&#34;YEAR&#34;),
    col(&#34;MONTH&#34;),
    col(&#34;&#39;search_engine&#39;&#34;).as_(&#34;SEARCH_ENGINE&#34;),
    col(&#34;&#39;social_media&#39;&#34;).as_(&#34;SOCIAL_MEDIA&#34;),
    col(&#34;&#39;video&#39;&#34;).as_(&#34;VIDEO&#34;),
    col(&#34;&#39;email&#39;&#34;).as_(&#34;EMAIL&#34;)
)
</code></pre>
<p>이 변환 결과를 확인하기 위해 출력을 <strong>Output</strong> 탭에 출력하는 Snowpark DataFrame의 <strong><em>show()</em></strong> 함수를 사용할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">print(&#34;Total Spend Across All Channels&#34;)
snow_df_spend_per_month.show()
</code></pre>
<h2 is-upgraded>연간 및 월별 총지출 데이터</h2>
<p>이제 <strong><em>group_by()</em></strong> 및 <strong><em>agg()</em></strong> 함수를 사용하여 수익 데이터를 연간 및 월별 수익으로 변환하겠습니다.</p>
<pre><code language="language-python" class="language-python">snow_df_revenue_per_month = snow_df_revenue.group_by(&#39;YEAR&#39;,&#39;MONTH&#39;).agg(sum(&#39;REVENUE&#39;)).sort(&#39;YEAR&#39;,&#39;MONTH&#39;).with_column_renamed(&#39;SUM(REVENUE)&#39;,&#39;REVENUE&#39;)
</code></pre>
<p>이 변환 결과를 확인하기 위해 출력을 <strong>Output</strong> 탭에 출력하는 Snowpark DataFrame의 <strong><em>show()</em></strong> 함수를 사용할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">print(&#34;Total Revenue per Year and Month&#34;)
snow_df_revenue_per_month.show()
</code></pre>
<h2 is-upgraded>모든 채널에 걸쳐 연간 및 월별 총지출 및 총수익 결합</h2>
<p>다음으로 이 수익 데이터를 변환된 캠페인 지출 데이터와 결합하겠습니다. 이렇게 하면 추가 분석과 모델 훈련을 위해 입력 피처(예: 채널당 비용) 및 대상 변수(예: 수익)를 단일 테이블로 로드할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend_and_revenue_per_month = snow_df_spend_per_month.join(snow_df_revenue_per_month, [&#34;YEAR&#34;,&#34;MONTH&#34;])
</code></pre>
<p>이 변환 결과를 확인하기 위해 출력을 <strong>Output</strong> 탭에 출력하는 Snowpark DataFrame의 <strong><em>show()</em></strong> 함수를 사용할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">print(&#34;Total Spend and Revenue per Year and Month Across All Channels&#34;)
snow_df_spend_and_revenue_per_month.show()
</code></pre>
<h2 is-upgraded>쿼리 설명 계획 검사</h2>
<p>Snowpark는 <strong><em>explain()</em></strong> Snowpark DataFrame 함수를 사용하여 DataFrame 쿼리와 실행 계획을 확인하는 것을 매우 쉽게 만듭니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend_and_revenue_per_month.explain()
</code></pre>
<p>위 문의 출력은 <strong>Output</strong> 탭에서 확인할 수 있습니다.</p>
<h2 is-upgraded>Output 탭</h2>
<p>워크시트를 실행한 후 <strong>Output</strong> 탭은 다음과 같습니다.</p>
<p class="image-container"><img alt="Worksheet" src="img/ac0cf51f6ca475ed.gif"></p>


      </google-codelab-step>
    
      <google-codelab-step label="변환된 데이터 저장" duration="1">
        <p>변환된 데이터를 추가 분석 및 또는 모델 훈련에 사용할 수 있도록 이를 <strong><em>SPEND_AND_REVENUE_PER_MONTH</em></strong> Snowflake 테이블에 저장하겠습니다.</p>
<pre><code language="language-python" class="language-python">snow_df_spend_and_revenue_per_month.write.mode(&#39;overwrite&#39;).save_as_table(&#39;SPEND_AND_REVENUE_PER_MONTH&#39;)
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="변환된 데이터 보기 및 반환" duration="1">
        <p>Python 워크시트의 반환 값 중 하나는 <strong><em>Table()</em></strong> 유형이며 여기에서 이를 설정하면 변환된 데이터를 Snowpark DataFrame으로 보고 반환할 수 있습니다.</p>
<pre><code language="language-python" class="language-python">return snow_df_spend_and_revenue_per_month
</code></pre>
<p>위 문의 출력은 <strong>Output</strong> 탭에서 아래와 같은 모습으로 확인할 수 있습니다.</p>
<h2 is-upgraded>Results 탭</h2>
<p>워크시트를 실행한 후 <strong>Results</strong> 탭은 다음과 같습니다.</p>
<p class="image-container"><img alt="Worksheet" src="img/ac0cf51f6ca475ed.gif"></p>


      </google-codelab-step>
    
      <google-codelab-step label="저장 프로시저로 배포" duration="2">
        <p>선택적으로 이 워크시트를 Python 저장 프로시저로 배포할 수도 있습니다. 이렇게 하면 예를 들어, <a href="https://docs.snowflake.com/ko/user-guide/tasks-intro" target="_blank">Snowflake 작업</a>을 사용하여 이를 예약할 수 있습니다. 이 워크시트를 배포하려면 오른쪽 상단에서 <strong>Deploy</strong> 버튼을 클릭하고 아래에서 보이는 것과 같이 지침을 따릅니다.</p>
<p class="image-container"><img alt="Deploy" src="img/451aa8ae3ac38799.png"></p>
<p>==================================================================================================</p>
<p class="image-container"><img alt="Deploy" src="img/4d0b09c660902d51.png"></p>
<h2 is-upgraded>저장 프로시저 보기</h2>
<p>배포된 후 저장 프로시저 세부 정보는 <strong>Data » Databases » SNOWPARK_DEMO_SCHEMA » Procedures</strong>에서 확인할 수 있습니다.</p>
<p class="image-container"><img alt="Deploy" src="img/7127631efb64d195.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="결론 및 리소스" duration="0">
        <p>축하합니다! Snowflake Python 워크시트에서 Snowpark를 사용하여 데이터 엔지니어링 작업을 성공적으로 수행하셨습니다.</p>
<p>이 Quickstart에 대한 피드백을 공유해 주시면 감사하겠습니다! 이 <a href="https://docs.google.com/forms/d/e/1FAIpQLScpCO4ekMB9kitQ6stQZ1NLqZf3VqbQfDrf7yRIwMQjty57_g/viewform?usp=sf_link" target="_blank">피드백 양식</a>을 사용하여 피드백을 제출해 주십시오.</p>
<h2 is-upgraded>학습한 내용</h2>
<ul>
<li>Snowflake 테이블에서 Snowpark DataFrame으로 데이터 로드하기</li>
<li>Snowpark DataFrame에서 탐색적 데이터 분석 수행하기</li>
<li>Snowpark DataFrame을 사용하여 여러 테이블의 데이터를 피벗 및 결합하기</li>
<li>변환된 데이터를 Snowflake 테이블에 저장하기</li>
<li>Python 워크시트를 저장 프로시저로 배포하기</li>
</ul>
<h2 is-upgraded>다음 단계</h2>
<p>증분적으로 데이터를 처리하고, Snowpark 작업과 데이터 파이프라인을 조정하고, CI/CD 파이프라인을 통해 이를 배포하고, Snowflake의 새로운 개발자 CLI 도구 및 Visual Studio Code 확장 프로그램을 사용하는 방법을 알아보려면 여정을 계속하고 <a href="/guide/data_engineering_pipelines_with_snowpark_python_kr/index.html" target="_blank">Snowpark Python을 사용한 데이터 엔지니어링 파이프라인</a>을 심층적으로 알아보십시오.</p>
<h2 is-upgraded>관련 리소스</h2>
<ul>
<li><a href="https://docs.snowflake.com/ko/developer-guide/snowpark/python/python-worksheets" target="_blank">Python 워크시트 개발자 가이드</a></li>
<li><a href="/guide/getting_started_with_dataengineering_ml_using_snowpark_python_kr/index.html" target="_blank">Snowpark for Python를 사용하여 데이터 엔지니어링 및 ML 시작하기</a></li>
<li><a href="https://quickstarts.snowflake.com/guide/getting_started_snowpark_machine_learning/index.html" target="_blank">Advanced:　Snowpark for Python Machine Learning Guide</a></li>
<li><a href="https://github.com/Snowflake-Labs/snowpark-python-demos/blob/main/README.md" target="_blank">Snowpark for Python 데모</a></li>
<li><a href="https://docs.snowflake.com/ko/developer-guide/snowpark/python/index.html" target="_blank">Snowpark for Python 개발자 가이드</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/native-shim.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/custom-elements.min.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/prettify.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("2025084205");
  </script>
</body>
</html>
