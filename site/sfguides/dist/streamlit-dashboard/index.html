
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Building a YouTube Analytics Dashboard with Streamlit in Snowflake Notebooks</title>

  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5Q8R2G');</script>
  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-08H27EW14N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-08H27EW14N');
</script>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Q8R2G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <google-codelab-analytics gaid="UA-41491190-9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="streamlit-dashboard"
                  title="Building a YouTube Analytics Dashboard with Streamlit in Snowflake Notebooks"
                  environment="web"
                  feedback-link="https://github.com/Snowflake-Labs/sfguides/issues">
    
      <google-codelab-step label="Overview" duration="5">
        <p>Have you ever wanted to create an interactive dashboard directly within your Snowflake environment? Many data professionals struggle with building visually appealing and interactive dashboards that can effectively communicate their data insights. This tutorial leverages Snowflake Notebooks combined with Streamlit to build a comprehensive YouTube analytics dashboard without leaving your Snowflake environment.</p>
<p>By the end of this guide, you&#39;ll have a fully functional dashboard that visualizes key YouTube metrics, allowing for interactive data exploration and analysis.</p>
<h2 class="checklist" is-upgraded>What You&#39;ll Learn</h2>
<ul class="checklist">
<li>Generate and structure sample data for dashboard visualization</li>
<li>Create interactive charts and metrics displays using Streamlit</li>
<li>Implement user controls for data filtering and visualization options</li>
</ul>
<h2 is-upgraded>What You&#39;ll Build</h2>
<p>You will create a YouTube analytics dashboard that displays metrics such as subscribers gained/lost, views, watch hours, likes, shares, and comments. The dashboard will feature interactive charts and user controls that allow for dynamic data filtering and visualization.</p>
<p>The dashboard displays key metrics, such as subscriber growth, views, and engagement statistics.</p>
<p class="image-container"><img alt="image" src="img/fe6c7c386bdf84c.jpeg"></p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Access to a Snowflake account (sign up for a <a href="https://signup.snowflake.com/" target="_blank">free trial account</a>) with permissions to use Snowflake Notebooks</li>
<li>Basic knowledge of Python programming</li>
<li>Familiarity with data manipulation using pandas</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Setup" duration="5">
        <h2 is-upgraded>Environment Configuration</h2>
<p>Begin by setting up your environment by importing the required libraries. We&#39;ll use pandas for data manipulation, numpy for numerical operations, datetime for handling dates, and streamlit for creating the dashboard interface.</p>
<h2 is-upgraded>Installation</h2>
<p>To install these libraries, you can click on the Packages drop-down found at the top menu followed by entering the name of the Python library:</p>
<p class="image-container"><img alt="image" src="img/1dbddef6195b06b6.jpeg"></p>
<aside class="special"><p> IMPORTANT: It should be noted that after adding packages, this will create the <code>environment.yml</code> file that encodes instruction for installing prerequisite libraries to run the notebook.</p>
</aside>
<h2 is-upgraded>Import libraries</h2>
<p>Let&#39;s start by importing our required libraries:</p>
<pre><code language="language-python" class="language-python">import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import streamlit as st
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Building the Dashboard Framework" duration="10">
        <p>Before diving into the implementation details, let&#39;s set up the framework for our dashboard. We&#39;ll start by generating sample YouTube channel data spanning 5 years with various metrics.</p>
<h2 is-upgraded>Generating Sample Data</h2>
<p>To create a realistic dashboard, we&#39;ll generate a synthetic YouTube channel dataset.</p>
<pre><code language="language-python" class="language-python"># Set random seed for reproducibility
np.random.seed(42)

# Generate dates for 5 years
start_date = datetime(2019, 8, 1)
end_date = datetime(2024, 9, 30)
date_range = pd.date_range(start=start_date, end=end_date, freq=&#39;ME&#39;)

# Initialize data structure
n_months = len(date_range)
data = {
    &#39;DATE&#39;: date_range.strftime(&#39;%Y-%m&#39;),
    &#39;SUBSCRIBERS_GAINED&#39;: np.zeros(n_months, dtype=int),
    &#39;SUBSCRIBERS_LOST&#39;: np.zeros(n_months, dtype=int),
    &#39;VIEWS&#39;: np.zeros(n_months, dtype=int),
    &#39;WATCH_HOURS&#39;: np.zeros(n_months, dtype=int),
    &#39;LIKES&#39;: np.zeros(n_months, dtype=int),
    &#39;SHARES&#39;: np.zeros(n_months, dtype=int),
    &#39;COMMENTS&#39;: np.zeros(n_months, dtype=int)
}

# Create DataFrame
df = pd.DataFrame(data)

# Function to generate growth
def generate_growth(start, end, months):
    return np.linspace(start, end, months)

# Generate growth patterns
subscribers_gained = generate_growth(30, 6000, n_months)
subscribers_lost = generate_growth(0, 1500, n_months)
views = generate_growth(300, 300000, n_months)
watch_hours = generate_growth(30, 30000, n_months)
likes = generate_growth(0, 15000, n_months)
shares = generate_growth(0, 3000, n_months)
comments = generate_growth(0, 1500, n_months)

# Add randomness and ensure integer values
for i, col in enumerate([&#39;SUBSCRIBERS_GAINED&#39;, &#39;SUBSCRIBERS_LOST&#39;, &#39;VIEWS&#39;, &#39;WATCH_HOURS&#39;, &#39;LIKES&#39;, &#39;SHARES&#39;, &#39;COMMENTS&#39;]):
    random_factor = np.random.normal(1, 0.1, n_months)  # Mean of 1, standard deviation of 0.1
    df[col] = np.maximum(0, (eval(col.lower()) * random_factor).astype(int))

# Seasonal variation (higher in summer)
summer_boost = np.sin(np.linspace(0, 2*np.pi, 12))
df[&#39;VIEWS&#39;] = df[&#39;VIEWS&#39;] * (1 + 0.2 * np.tile(summer_boost, n_months // 12 + 1)[:n_months])

# Occasional viral videos (once every 6 months on average)
viral_months = np.random.choice(range(1, n_months), size=n_months // 6, replace=False)
df.loc[viral_months, [&#39;VIEWS&#39;, &#39;LIKES&#39;, &#39;SHARES&#39;, &#39;COMMENTS&#39;]] = df.loc[viral_months, [&#39;VIEWS&#39;, &#39;LIKES&#39;, &#39;SHARES&#39;, &#39;COMMENTS&#39;]] * 5

# Ensure integer values
for col in df.columns:
    if col != &#39;DATE&#39;:
        df[col] = df[col].astype(int)

# Calculate cumulative subscribers
df[&#39;NET_SUBSCRIBERS&#39;] = (df[&#39;SUBSCRIBERS_GAINED&#39;] - df[&#39;SUBSCRIBERS_LOST&#39;])

# Ensure no negative values
df[df.select_dtypes(include=[np.number]).columns] = df.select_dtypes(include=[np.number]).clip(lower=0)

# Convert DATE column to datetime
df[&#39;DATE&#39;] = pd.to_datetime(df[&#39;DATE&#39;])
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Building the Interactive Dashboard" duration="15">
        <h2 is-upgraded>Helper functions</h2>
<p>First, let&#39;s create helper functions for powering the dashboard with the data and charts.</p>
<p>Here&#39;s the code for creating our helper functions:</p>
<pre><code language="language-python" class="language-python"># Header for the app
st.header(&#34;Cumulative Stats&#34;)

# Helper functions for data formatting and aggregation
def format_with_commas(number):
    return f&#34;{number:,}&#34;

def aggregate_data(df, freq):
    return df.resample(freq, on=&#39;DATE&#39;).agg({
        &#39;VIEWS&#39;: &#39;sum&#39;,
        &#39;WATCH_HOURS&#39;: &#39;sum&#39;,
        &#39;NET_SUBSCRIBERS&#39;: &#39;sum&#39;,
        &#39;LIKES&#39;: &#39;sum&#39;
    }).reset_index()

def create_chart(y, color, height, chart_type):
    if chart_type==&#39;Bar&#39;:
        st.bar_chart(df_display, x=&#34;DATE&#34;, y=y, color=color, height=height)
    if chart_type==&#39;Area&#39;:
        st.area_chart(df_display, x=&#34;DATE&#34;, y=y, color=color, height=height)
</code></pre>
<h2 is-upgraded>Interactive widgets</h2>
<p>To introduce interactivity to the dashboard, we&#39;re leveraging input widgets for data range selection, time frame filtering, chart type selection:</p>
<pre><code language="language-python" class="language-python"># Input widgets
# Date range selection
col = st.columns(4)
with col[0]:
    start_date = st.date_input(&#34;Start date&#34;, df[&#39;DATE&#39;].min().date())
with col[1]:
    end_date = st.date_input(&#34;End date&#34;, df[&#39;DATE&#39;].max().date())
# Time frame selection
with col[2]:
    time_frame = st.selectbox(&#34;Select time frame&#34;,
        (&#34;Daily&#34;, &#34;Weekly&#34;, &#34;Monthly&#34;, &#34;Quarterly&#34;)
    )
# Chart type
with col[3]:
    chart_selection = st.selectbox(&#34;Select a chart type&#34;,
                                  (&#34;Bar&#34;, &#34;Area&#34;))

st.divider()
</code></pre>
<h2 is-upgraded>Data filtering</h2>
<p>Next, the data is filtered by using the aforementioned user-provided input widgets. Thus, with each widget interaction, the data is filtered in real-time to display a custom request.</p>
<pre><code language="language-python" class="language-python"># Filter data based on date range
mask = (df[&#39;DATE&#39;].dt.date &gt;= start_date) &amp; (df[&#39;DATE&#39;].dt.date &lt;= end_date)
df_filtered = df.loc[mask]

# Aggregate data based on selected time frame
if time_frame == &#39;Daily&#39;:
    df_display = df_filtered
elif time_frame == &#39;Weekly&#39;:
    df_display = aggregate_data(df_filtered, &#39;W-MON&#39;)
elif time_frame == &#39;Monthly&#39;:
    df_display = aggregate_data(df_filtered, &#39;ME&#39;)
elif time_frame == &#39;Quarterly&#39;:
    df_display = aggregate_data(df_filtered, &#39;QE&#39;)


# Compute metric growth based on selected time frame
if len(df_display) &gt;= 2:
    subscribers_growth = int(df_display.NET_SUBSCRIBERS.iloc[-1] - df_display.NET_SUBSCRIBERS.iloc[-2])
    views_growth = int(df_display.VIEWS.iloc[-1] - df_display.VIEWS.iloc[-2])
    watch_hours_growth = int(df_display.WATCH_HOURS.iloc[-1] - df_display.WATCH_HOURS.iloc[-2])
    likes_growth = int(df_display.LIKES.iloc[-1] - df_display.LIKES.iloc[-2])
else:
    subscribers_growth = views_growth = watch_hours_growth = likes_growth = 0
</code></pre>
<h2 is-upgraded>Dashboard Charts</h2>
<p>Now, here is where we lay the charts and DataFrame elements onto the dashboard with the help of <code>st.columns()</code>.</p>
<pre><code language="language-python" class="language-python"># Create metrics columns
cols = st.columns(4)
with cols[0]:
    st.metric(&#34;Subscribers&#34;, 
              format_with_commas(df_display.NET_SUBSCRIBERS.sum()),
              format_with_commas(subscribers_growth)
             )
    create_chart(y=&#34;NET_SUBSCRIBERS&#34;, color=&#34;#29B5E8&#34;, height=200, chart_type=chart_selection)
with cols[1]:
    st.metric(&#34;Views&#34;, 
              format_with_commas(df_display.VIEWS.sum()), 
              format_with_commas(views_growth)
             )
    #st.bar_chart(df_display, x=&#34;DATE&#34;, y=&#34;VIEWS&#34;, color=&#34;#FF9F36&#34;, height=200)
    create_chart(y=&#34;VIEWS&#34;, color=&#34;#FF9F36&#34;, height=200, chart_type=chart_selection)
with cols[2]:
    st.metric(&#34;Watch Hours&#34;, 
              format_with_commas(df_display.WATCH_HOURS.sum()), 
              format_with_commas(watch_hours_growth)
             )
    #st.bar_chart(df_display, x=&#34;DATE&#34;, y=&#34;WATCH_HOURS&#34;, color=&#34;#D45B90&#34;, height=200)
    create_chart(y=&#34;WATCH_HOURS&#34;, color=&#34;#D45B90&#34;, height=200, chart_type=chart_selection)
with cols[3]:
    st.metric(&#34;Likes&#34;, 
              format_with_commas(df_display.LIKES.sum()), 
              format_with_commas(likes_growth)
             )
    #st.bar_chart(df_display, x=&#34;DATE&#34;, y=&#34;LIKES&#34;, color=&#34;#7D44CF&#34;, height=200)
    create_chart(y=&#34;LIKES&#34;, color=&#34;#7D44CF&#34;, height=200, chart_type=chart_selection)

# Display filtered DataFrame
with st.expander(&#34;See filtered data&#34;):
    st.dataframe(df_display)
</code></pre>
<p>The end product?</p>
<p>A stunning interactive, dashboard right inside the notebook:</p>
<p class="image-container"><img alt="image" src="img/6a6b8673f6aeb972.gif"></p>
<p>As you can see, the app is responsive and instantaneously updates as we adjust various widgets.</p>
<h2 is-upgraded>Dashboard DataFrame</h2>
<p>Aside from charts, we can also display a DataFrame that inherently support the display of mini-charts directly in the columns.</p>
<p>So, we&#39;ll start by aggregating the data to a yearly format.</p>
<pre><code language="language-python" class="language-python"># Function to aggregate data by year, showing monthly values as lists
def aggregate_by_year(df):
    # Convert DATE to datetime
    df[&#39;DATE&#39;] = pd.to_datetime(df[&#39;DATE&#39;])
    
    # Function to create a list of monthly values
    def monthly_list(x):
        return list(x)
    
    # Group by year and aggregate
    yearly_data = df.groupby(df[&#39;DATE&#39;].dt.year).agg({
        &#39;SUBSCRIBERS_GAINED&#39;: monthly_list,
        &#39;SUBSCRIBERS_LOST&#39;: monthly_list,
        &#39;VIEWS&#39;: monthly_list,
        &#39;WATCH_HOURS&#39;: monthly_list,
        &#39;LIKES&#39;: monthly_list,
        &#39;SHARES&#39;: monthly_list,
        &#39;COMMENTS&#39;: monthly_list,
        &#39;NET_SUBSCRIBERS&#39;: lambda x: list(x)[-1]  # Take the last value of the year
    }).reset_index()
    
    # Rename DATE column to YEAR
    yearly_data = yearly_data.rename(columns={&#39;DATE&#39;: &#39;YEAR&#39;})
    
    return yearly_data

df2 = aggregate_by_year(df)
</code></pre>
<p>Next, we&#39;ll display this interactive DataFrame with built-in chart displays:</p>
<p class="image-container"><img alt="image" src="img/d9654d92a84c8583.jpeg"></p>
<p>And this is implemented using the following code snippet:</p>
<pre><code language="language-python" class="language-python"># Display DataFrame with built-in chart displays using column_config
st.dataframe(
    df2,
    column_config={
        &#34;NET_SUBSCRIBERS&#34;: st.column_config.ProgressColumn(
            &#34;NET_SUBSCRIBERS&#34;,
            min_value=df.NET_SUBSCRIBERS.min(),
            max_value=df.NET_SUBSCRIBERS.max(),
            format=&#34;%s&#34;
        ),
        &#34;VIEWS&#34;: st.column_config.BarChartColumn(
            &#34;VIEWS&#34;,
            y_min=df.VIEWS.min(),
            y_max=df.VIEWS.max(),
        ),
        &#34;WATCH_HOURS&#34;: st.column_config.BarChartColumn(
            &#34;WATCH_HOURS&#34;,
            y_min=df.WATCH_HOURS.min(),
            y_max=df.WATCH_HOURS.max(),
        ),
        &#34;LIKES&#34;: st.column_config.LineChartColumn(
            &#34;LIKES&#34;,
            y_min=df.SHARES.min(),
            y_max=df.SHARES.max(),
        ),
        &#34;SHARES&#34;: st.column_config.LineChartColumn(
            &#34;SHARES&#34;,
            y_min=df.SHARES.min(),
            y_max=df.SHARES.max(),
        ),
        &#34;COMMENTS&#34;: st.column_config.LineChartColumn(
            &#34;COMMENTS&#34;,
            y_min=df.COMMENTS.min(),
            y_max=df.COMMENTS.max(),
        ),
    },
    column_order=(&#34;YEAR&#34;,
                  &#34;NET_SUBSCRIBERS&#34;,
                  &#34;VIEWS&#34;,
                  &#34;WATCH_HOURS&#34;,
                  &#34;LIKES&#34;,
                  &#34;SHARES&#34;,
                  &#34;COMMENTS&#34;),
    hide_index=True
)
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusion and Resources" duration="5">
        <p>Congratulations! You&#39;ve successfully built a comprehensive YouTube analytics dashboard using Streamlit within Snowflake Notebooks. This dashboard allows you to visualize key metrics, interactively filter data, and gain valuable insights directly within your Snowflake environment. Happy coding!</p>
<h2 is-upgraded>What You Learned</h2>
<ul>
<li>How to generate and structure sample data for dashboard visualization</li>
<li>Creating interactive charts and metrics displays using Streamlit</li>
<li>Implementing user controls for data filtering and visualization options</li>
</ul>
<p>For a step-by-step walkthrough, check out the complementary video:</p>
<p>The repository to the notebook is available <a href="https://github.com/Snowflake-Labs/snowflake-demo-notebooks/tree/main/Dashboard_with_Streamlit" target="_blank">here</a>.</p>
<h2 is-upgraded>Related Resources</h2>
<p>Tutorial videos:</p>
<ul>
<li><a href="https://www.youtube.com/watch?v=LrQwXQm28qE" target="_blank">Watch complementary tutorial video</a></li>
<li><a href="https://www.youtube.com/watch?v=YB1B6vcMaGE&list=PLavJpcg8cl1Efw8x_fBKmfA2AMwjUaeBI" target="_blank">YouTube Playlist on Snowflake Notebooks</a></li>
</ul>
<p>Documentation:</p>
<ul>
<li><a href="https://docs.snowflake.com/en/user-guide/ui-snowsight/notebooks" target="_blank">About Snowflake Notebooks</a></li>
<li><a href="https://docs.streamlit.io/" target="_blank">Streamlit Documentation</a></li>
<li><a href="https://docs.snowflake.com/" target="_blank">Snowflake Documentation</a></li>
</ul>
<p>Additional Reading:</p>
<ul>
<li><a href="https://docs.streamlit.io/develop/api-reference/data/st.metric" target="_blank">st.metric</a></li>
<li><a href="https://docs.streamlit.io/develop/api-reference/charts/st.area_chart" target="_blank">st.area_chart</a></li>
<li><a href="https://docs.streamlit.io/develop/api-reference/charts/st.bar_chart" target="_blank">st.bar_chart</a></li>
<li><a href="https://docs.streamlit.io/develop/api-reference/data/st.dataframe" target="_blank">st.dataframe</a></li>
<li><a href="https://docs.streamlit.io/develop/api-reference/data/st.column_config" target="_blank">st.column_config</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/native-shim.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/custom-elements.min.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/prettify.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("2025084205");
  </script>
</body>
</html>
