
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Getting Started with Microsoft Purview and Snowflake</title>

  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5Q8R2G');</script>
  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-08H27EW14N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-08H27EW14N');
</script>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Q8R2G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <google-codelab-analytics gaid="UA-41491190-9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="getting_started_with_microsoft_purview_and_snowflake"
                  title="Getting Started with Microsoft Purview and Snowflake"
                  environment="web"
                  feedback-link="https://github.com/Snowflake-Labs/sfguides/issues">
    
      <google-codelab-step label="Overview" duration="5">
        <p>Snowflake Horizon is a built-in governance solution that helps users manage their data ecosystem. It provides a unified platform that supports five core pillars of data governance: compliance, security, privacy, interoperability, and access. These capabilities enable users to govern data, apps, and more across clouds, teams, partners, and customers. That interoperability works with Microsoft Purview, which extends the unified data governance solution to help you manage services across your entire Microsoft estate. These services include Azure storage services, Power BI, databases like SQL or Hive, file services, applications, and many more.</p>
<p>In this Quickstart you will create a data catalog demonstrating how to use Purview to increase the visibility of your Snowflake data objects, allowing you to easily manage your Snowflake data, as well as your larger Microsoft data ecosystem.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Familiarity with Azure and an Azure account, and a Purview workspace</li>
</ul>
<h2 is-upgraded>What You Will Learn</h2>
<ul>
<li>deploy Microsoft Purview</li>
<li>set up a Snowflake database, and scan that data using Purview</li>
<li>classify, label, and view lineage of your data</li>
</ul>
<h2 is-upgraded>What You Will Need</h2>
<ul>
<li>A free <a href="https://signup.snowflake.com/?utm_cta=quickstarts_" target="_blank">Snowflake Account</a></li>
<li><a href="https://azure.microsoft.com/en-us/free/search/?ef_id=_k_2ba2be3ad9791e57964fda0c62ccd55c_k_&OCID=AIDcmm5edswduu_SEM_k_2ba2be3ad9791e57964fda0c62ccd55c_k_&msclkid=2ba2be3ad9791e57964fda0c62ccd55c" target="_blank">Azure Account</a> with Purview</li>
</ul>
<h2 is-upgraded>What You Will Build</h2>
<p>You will create a Purview instance with a catalog of classified Snowflake data and lineage to track where your data comes from and where it gets used.</p>
<h2 is-upgraded>Use Case</h2>
<p>This use case will leverage sample retail data to register and scan that data source into Purview demonstrating how a Data Steward would manage, monitor, and classify the data under their domain. The use case also gives insight to how Snowflake data is being used in conjunction within their Azure environment.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Set Up Snowflake Environment" duration="5">
        <p>The first thing to do is create a database and warehouse in your Snowflake environment. Run the below code in a Snowflake worksheet. You are using the AccountAdmin role here for demo purposes, but in production you will likely use a different role.</p>
<pre><code language="language-sql" class="language-sql">--create database and warehouse
use role accountadmin;
CREATE OR REPLACE WAREHOUSE PURVIEWLAB_WH WITH WAREHOUSE_SIZE=&#39;X-SMALL&#39;;
CREATE OR REPLACE DATABASE PURVIEWLAB;
CREATE OR REPLACE SCHEMA RAW;
CREATE OR REPLACE SCHEMA HARMONIZED;
CREATE OR REPLACE SCHEMA ANALYTICS;

--create database and warehouse
create or replace TABLE PurviewLab.RAW.CUSTOMER (
	CUSTOMER_ID NUMBER(38,0),
	NAME VARCHAR(100) ,
	CITY VARCHAR(100) ,
	PHONE_NUMBER VARCHAR(100) 
);

INSERT INTO PurviewLab.RAW.CUSTOMER (CUSTOMER_ID, NAME,CITY,PHONE_NUMBER)
VALUES 
(1,&#39;Rodolfo Tucker&#39;,&#39;Hamburg&#39;,&#39;(007)506-6068&#39;),
(2,&#39;Karla Mullen&#39;,&#39;Rio de Janeiro&#39;,&#39;(431)122-6142&#39;),
(3,&#39;Cortez Douglas&#39;,&#39;Paris&#39;,&#39;(157)518-3848&#39;),
(4,&#39;Janiya Pope&#39;,&#39;Krakow&#39;,&#39;(872)718-6879&#39;),
(5,&#39;Zaiden Knapp&#39;,&#39;Barcelona&#39;,&#39;(545)152-4832&#39;),
(6,&#39;Micah Beard&#39;,&#39;Hamburg&#39;,&#39;(535)753-3461&#39;),
(7,&#39;Ricardo Byrd&#39;,&#39;Barcelona&#39;,&#39;(138)082-1391&#39;),
(8,&#39;Marie Boyer&#39;,&#39;New York&#39;,&#39;(587)006-4451&#39;),
(9,&#39;Josie Glass&#39;,&#39;Stockholm&#39;,&#39;(023)863-4028&#39;),
(10,&#39;Korbin Ward&#39;,&#39;Cairo&#39;,&#39;(049)196-8102&#39;);

select * from frostbyte_tasty_bytes.analytics.customer_loyalty_metrics_v;

create or replace TABLE PurviewLab.RAW.ORDERS (
	ORDER_ID NUMBER(38,0),
	CUSTOMER_ID NUMBER(38,0),
	ORDER_TOTAL NUMBER(38,4)
);

INSERT INTO PurviewLab.RAW.ORDERS (ORDER_ID, CUSTOMER_ID,ORDER_TOTAL)
VALUES 
(1,1,11.0000),
(2,1,42.0000),
(3,1,33.0000),
(4,2,6.0000),
(5,2,5.0000),
(6,3,5.0000),
(7,3,6.0000),
(8,3,37.0000),
(9,3,11.0000),
(10,4,16.0000),
(11,5,24.0000),
(12,5,21.0000),
(13,6,17.0000),
(14,6,9.0000),
(15,6,13.0000),
(16,7,22.0000),
(17,8,34.0000),
(18,8,14.0000),
(19,9,25.0000),
(20,10,4.0000),
(21,10,18.0000);


create or replace view PurviewLab.HARMONIZED.CUSTOMER_METRICS_V AS 
SELECT 
    cl.customer_id,
    cl.city,
    cl.name,
    cl.phone_number,
    SUM(oh.order_total) AS total_sales
FROM PurviewLab.RAW.CUSTOMER cl
JOIN PurviewLab.RAW.ORDERS oh
ON cl.customer_id = oh.customer_id
GROUP BY cl.customer_id, cl.city, cl.name, cl.phone_number;


create or replace view PurviewLab.ANALYTICS.CUSTOMER_ORDERS_V
 as
SELECT CUSTOMER_ID, NAME, TOTAL_SALES FROM PurviewLab.HARMONIZED.CUSTOMER_METRICS_V;

create or replace view PurviewLab.ANALYTICS.LOCATION_ORDERS_V
 as
SELECT CITY, SUM(TOTAL_SALES) as TOTAL_SALES FROM PurviewLab.HARMONIZED.CUSTOMER_METRICS_V GROUP BY CITY;
</code></pre>
<p>This SQL has set up the data you&#39;ll scan and work with in Purview later in the Quickstart.</p>
<p>The result should look like this screenshot with tables, views, and schemas: <img src="img/e6e777ccd930b089.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Set Up Azure Environment" duration="5">
        <h2 is-upgraded>Set Up Microsoft Purview</h2>
<p>Now you need to set up your Purview instance.</p>
<ol type="1">
<li>From the Azure Marketplace, search for Purview. <ul>
<li>Click Create.</li>
<li>Enter your Subscription, Resource group, an Account Name, and Location.</li>
<li>Under Networking, select either Public Endpoints.</li>
<li>Under Review + Create, click Create.</li>
</ul>
</li>
</ol>
<p class="image-container"><img src="img/8b96b8269a93f3fb.png"></p>
<ol type="1" start="2">
<li>Once created go to the new resource. <ul>
<li>Click on Open Microsoft Purview Governance Portal.</li>
</ul>
</li>
</ol>
<p class="image-container"><img src="img/c9f29c7dc80fcd98.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Purview Workspace Overview" duration="5">
        <p>Once in the Purview workspace, there are a number of options on the left panel.</p>
<ol type="1">
<li>Data Catalog <ul>
<li>Home - Search your Data Catalog.</li>
<li>Browse - Manually browse through the Catalog.</li>
<li>Business Assets - Group data into data products.</li>
<li>Glossary - Create data vocabulary and terms for business users.</li>
</ul>
</li>
<li>Data Map <ul>
<li>Map out your registered data sources into collections.</li>
<li>Set up scans, monitor scan progress, and define classifications.</li>
</ul>
</li>
<li>Data Estate Insights <ul>
<li>Review metrics around your data assets, usage, and completeness of metadata.</li>
</ul>
</li>
<li>Data Policy <ul>
<li>Access controls to data sources.</li>
</ul>
</li>
<li>Management <ul>
<li>Manage the Purview workspace, credentials, private endpoints.</li>
</ul>
</li>
<li>Privacy <ul>
<li>Set additional data privacy controls.</li>
</ul>
</li>
</ol>
<p><img src="img/ff74c22b35afffa2.png"><a href="assets/Workspace.png" target="_blank"></a></p>


      </google-codelab-step>
    
      <google-codelab-step label="Scanning and the Catalog" duration="10">
        <p>Now you need to register Snowflake as a data source, which will allow you to scan Snowflake data into the catalog.</p>
<ol type="1">
<li>From the Data Map <ul>
<li>Click Register.</li>
<li>Search for Snowflake and continue.</li>
<li>Fill in the name and server information.</li>
<li>Assign a collection. Collections are a way to group data sources, assets, and objects in a logical way for your organization. In this case just keep it set to the Root collection.</li>
</ul>
</li>
<li>Once created you will see your Snowflake source added to the Data Map. From here you can edit, run scans, and view details on the history of the object. <ul>
<li>Click New Scan and give it a Name.</li>
<li>Create new Credentials. Fill in the User Name, add a connection to a Key Vault where the credentials are stored, and enter the Secret Name from the vault.</li>
<li>Back in the scan information, add in the PURVIEWLAB_WH for Warehouse and PURVIEWLAB for Database.</li>
<li>Test the connection and then continue.</li>
<li>Set up the scan to occur on a schedule. In this case, select once for a single scan.</li>
<li>Click Save and Run. It may take a few minutes to run the scan. You can click on view details on the Snowflake object to see the status.</li>
</ul>
</li>
</ol>
<p class="image-container"><img src="img/cb9211e846204a99.png"></p>
<ol type="1" start="3">
<li>Once the scan is complete, go into the Data Catalog on the left menu. This allows you to view all of the objects scanned from Snowflake. <ul>
<li>Click Browse on the left and select the collection.</li>
<li>This will show all the objects that were scanned. You can filter by table, procedure, etc.</li>
</ul>
</li>
</ol>
<p class="image-container"><img src="img/a16b56405fcb77fe.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Classification and Lineage" duration="5">
        <p>Classifications categorize data based on its sensitivity, importance, or usage, enabling you to apply appropriate access controls, cryptions, and retention policies. They help mitigate the risk of data breaches or regulator non-compliance.</p>
<p>From the Data Catalog Home page, search for &#34;CUSTOMER_METRICS_V&#34;</p>
<ul>
<li>Click on the view. This takes you to the overview page for the object.</li>
<li>Click Schema and you will see the view schema, fields, data types, and any assigned glossary terms describing the data.</li>
<li>Under classifications you&#39;ll see that the scan has auto-classified Cities as &#34;World Cities&#34; and Name as &#34;All Full Names.&#34;</li>
</ul>
<p class="image-container"><img src="img/d5b45633877e54a3.png"></p>
<p>Now add a manual classification.</p>
<ul>
<li>Click on the Column Name phone_number.</li>
<li>At the top select Edit.</li>
<li>Under Classifications search &#34;U.S. Phone Number&#34; and check it.</li>
<li>Click Certified to indicate this data set has been certified as reliable and meeting organizational standards.</li>
<li>Click Save then Close.</li>
</ul>
<p class="image-container"><img src="img/eeb000fd40bb5170.png"></p>
<p>Lineage tracks the origin, transformation, and movement of data throughout its lifecycles, providing a comprehensive audit trail. This creates transparency and accountability and also facilitates troubleshooting and impact analysis.</p>
<p>Now click Lineage at the top. This view will show how this data object ties to upstream and downstream data entities.</p>
<ul>
<li>In this case Customer_Metrics_V has data that comes from the tables Orders and Customers. And this view is used later in the views Customer_Orders and Location_Orders.</li>
</ul>
<p class="image-container"><img src="img/c895d4f3bdef1e67.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Data Estate Insights" duration="5">
        <p>The data estate insights show a comprehensive overview of your organization&#39;s data ecosystem. It highlights key metrics such as number of data sources, assets, data health, and usage patterns. These metrics can help you identify what data your organization needs the most and what data needs to be curated and defined.</p>
<p>Note: Data Insights may take 24 hours to populate after first scanning data.</p>
<ol type="1">
<li>Data Stewardship<ul>
<li>This view shows key data health and performance metrics: <ul>
<li>number of assets</li>
<li>data curated by assigned owners, classifications, and descriptions</li>
<li>amount of sensitive data</li>
<li>out-of-date scans</li>
</ul>
</li>
</ul>
</li>
<li>Catalog Adoption<ul>
<li>This view shows key engagement and usage metrics: <ul>
<li>number of catalog users and searches</li>
<li>asset and keyword engagement</li>
</ul>
</li>
</ul>
</li>
</ol>
<p class="image-container"><img src="img/134978273bc55440.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusion and Resources" duration="5">
        <p>Congratulations! You&#39;ve successfully set up Microsoft Purview. You have scanned your Snowflake data, classified and labeled. You can now monitor your data estate and see how the data you prepare in the Snowflake platform is used downstream in Azure and Microsoft services.</p>
<h2 is-upgraded>What You Learned</h2>
<ul>
<li>how to deploy Microsoft Purview</li>
<li>how to scan your Snowflake data objects and classify them</li>
<li>how to monitor data health, track lineage, and map your data estate</li>
</ul>
<h2 is-upgraded>Related Resources</h2>
<p>This Quickstart is just that, a quick way to get you started with Purview and Snowflake. You will want to consider the additional items below for enterprise-grade workloads:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/purview/register-scan-snowflake" target="_blank">Official Documentation</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/native-shim.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/custom-elements.min.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/prettify.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("2025084205");
  </script>
</body>
</html>
