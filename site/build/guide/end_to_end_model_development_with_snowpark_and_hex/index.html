
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>End to End Model Development with Hex and Snowpark</title>

  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5Q8R2G');</script>
  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-08H27EW14N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-08H27EW14N');
</script>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Q8R2G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <google-codelab-analytics gaid="UA-41491190-9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="end_to_end_model_development_with_snowpark_and_hex"
                  title="End to End Model Development with Hex and Snowpark"
                  environment="web"
                  feedback-link="https://github.com/Snowflake-Labs/sfguides/issues">
    
      <google-codelab-step label="Overview" duration="5">
        <p>In this quickstart, we will be utilizing the classic Titanic dataset to determine if we would survive the infamous maiden voyage. Highlights of the quickstart include, preprocessing, model training, registry, and finally an interactive Hex app for inference. By the end of this lab you will learn how to leverage Snowpark ML, Hex&#39;s Snowpark intergration, and Snowflake&#39;s Model Registry.</p>
<h2 is-upgraded>Prerequisites</h2>
<ul>
<li>Familiarity with basic Python and SQL</li>
<li>Familiarity with training ML models</li>
<li>Familiarity with data science notebooks</li>
<li>A <a href="https://signup.snowflake.com/?utm_cta=quickstarts_" target="_blank">Snowflake</a> account (if you are using an enterprise account through your organization, it is unlikely that you will have the privileges to use the <code>ACCOUNTADMIN</code> role, which is required for this lab).</li>
</ul>
<p>Head over to the <a href="https://signup.snowflake.com/?utm_cta=quickstarts_" target="_blank">Snowflake</a> sign-up page and register for a free account. Once you&#39;ve registered, you&#39;ll get an email that will bring you to Snowflake so that you can sign in.</p>
<h3 is-upgraded>Connecting Snowflake with Hex</h3>
<p>If you have an existing Hex account, login in to your account and continue to the <strong>What You Will Learn</strong> section below.</p>
<p>Otherwise, once you&#39;ve logged into your Snowflake account, simply navigate to the <code>Data Products</code> tab on the left and click <code>Partner connect</code>. In the search bar at the top, type in <code>Hex</code>, and you should see the Hex partner connect tile appear. Clicking on the tile will bring up a new screen, and all you have to do is to press the <code>Connect</code> button in the lower right corner. After this, you&#39;ll see a new screen confirming that your account has been created and from here you can click <code>Activate</code>.</p>
<h3 is-upgraded>Creating a workspace</h3>
<p>Once activated, you&#39;ll be brought over to Hex and will be prompted to create/name your new workspace.</p>
<p class="image-container"><img src="img/f8f4292e155d9c3b.png"></p>
<h3 is-upgraded>Workflow roadblocks</h3>
<p>The following issues may occur if you have an existing Hex account and you&#39;re not an Admin in that org.</p>
<p><strong>Unauthorized error</strong></p>
<p>If you have an existing Hex account that was created with a password and username, you may run into an &#34;Unauthorized&#34; error when activating your workspace in Partner Connect. If this is your experience, head over to <a href="https://hex.tech" target="_blank">hex.tech</a> and login with your password and username.</p>
<p><strong>Plan upgrade</strong></p>
<p>If you are an existing Hex user currently on a Community plan, you may encounter an issue that will prevent you from using Partner Connect. If you&#39;re unclear on what Hex plan you are on, feel free to reach out to <a href="mailto:support@hex.tech" target="_blank">support@hex.tech</a>. If you are the Admin of your organization, you can see your plan under Manage plan on the Settings page. To extend a trial, email <a href="mailto:support@hex.tech" target="_blank">support@hex.tech</a> with the subject &#34;VHOL trial extension.&#34;</p>
<p><strong>Role privileges</strong></p>
<p>If you do not have an Editor role or higher, you won&#39;t be able to create data connections in your workspace. To upgrade your role, contact your workspace Admin. You can find out who this is by navigating to Settings -&gt; Users &amp; groups within your Hex workspace.</p>
<p><em>If you&#39;re still encountering issues, or encounter any issues other than the ones listed above, please contact our support team </em><a href="mailto:support@hex.tech" target="_blank"><em>support@hex.tech</em></a><em> with the subject &#34;VHOL&#34; for priority support.</em></p>
<h2 is-upgraded>What You Will Learn</h2>
<ul>
<li>How to perform preprocessing with Snowpark ML</li>
<li>How to perform model training with Snowpark ML</li>
<li>How to register the model in Snowflakes Registry</li>
<li>How models are &#34;deployed&#34; in Snowflake</li>
<li>How to perform inference using Snowpark and SQL against the registered model</li>
</ul>
<h2 is-upgraded>What You Will Build</h2>
<p>In this quickstart, you will create machine learning model using Snowpark ML. This model will be registered to Snowflake&#39;s Model Registry and then we will call that model for inference. At the end, we will build a Hex app that calls the newly created model to predict our likelihood of surviving the infamous maiden voyage!</p>


      </google-codelab-step>
    
      <google-codelab-step label="Getting Started with Hex" duration="5">
        <p>Now we can move back over to Hex and get started on our project. The first thing you&#39;ll need to do is transfer the Hex project into your new or existing Hex org.</p>
<p><a href="https://app.hex.tech/hex-public/hex/30a29735-a269-4e41-a6f7-84fb0414124b/draft/logic" target="_blank"><paper-button class="colored" raised>Get Hex project</paper-button></a></p>
<ul>
<li>Select Get a copy.</li>
<li>Select your new or existing Hex org.</li>
</ul>
<p>Now that you&#39;ve got your project, you will find yourself in the <a href="https://learn.hex.tech/docs/develop-logic/logic-view-overview" target="_blank">Logic view</a> of a Hex project. The Logic view is a notebook-like interface made up of cells such as code cells, markdown cells, input parameters and more! On the far left side, you&#39;ll see a control panel that will allow you to do things like upload files, import data connections, or search your project. Before we dive into the code, we&#39;ll need to import our Snowflake connection to our project.</p>
<p>We can import our Snowflake data connection by heading over to the <code>Data sources</code> tab represented by a database icon with a lightning bolt. At the bottom of this section, you&#39;ll see a portion that says available workspace connections and you should see one that says Snowflake if you created the Hex account via Partner Connect.</p>
<p class="image-container"><img src="img/c50263f87d45efee.png"></p>
<p>If you had an existing Hex org and did not create one via Partner Connect please follow <a href="https://learn.hex.tech/docs/connect-to-data/data-connections/data-connections-introduction" target="_blank">Hex documentation</a> on creating a Snowflake connection.</p>
<h2 is-upgraded>Common Problems</h2>
<p>If coming from Partner Connect or creating a new database connection, ensure that your database connection has both the Snowpark and Writeback toggle enabled. Navigate to the Settings window and select the desired Snowflake database connection.</p>
<p class="image-container"><img src="img/29fd60000b1c6a7.png"></p>
<p>Enable the Snowpark and Writeback toggles.</p>
<p class="image-container"><img src="img/570ccb3932397808.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Write the data back to Snowflake" duration="5">
        <p>Now that you have the Hex project, let&#39;s write the data into the imported Snowflake instance. To do this, we&#39;ll use one of Hex&#39;s utility cells called the <a href="https://learn.hex.tech/docs/logic-cell-types/writeback-cells" target="_blank">writeback cell</a>. What this cell does is exactly what it sounds like, writes data back to a database.</p>
<p>Using this cell is quite simple. First we&#39;ll need choose the source data from the dataframes currently in the project that we want to write back into Snowflake. The dataframe we&#39;ll want to write back is our <code>titanic</code> dataframe, so we&#39;ll choose <code>titanic</code> from our list. The next step is to select our Snowflake connection as the warehouse that we want to write the data to. Once complete, we&#39;ll choose the database and schema, then we can name our table. For the database, choose <code>PC_HEX_DB</code> and use the <code>PUBLIC</code> schema. For the table name, use <code>TITANIC_DATA</code>.</p>
<p class="image-container"><img src="img/a71ed9b89b8f8a1c.png"></p>
<p><strong><em>NOTE:</em></strong> If you did not come from Partner Connect you will not see the <code>PC_HEX_DB</code> database and <code>PUBLIC</code> schema. You can create or use an existing database and schema.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Create a Snowpark Session" duration="3">
        <p>Now, we can connect to our Snowflake connection that we imported earlier. To do this head over to the data sources tab on the left control panel to find your Snowflake connection. If you hover your mouse over the connection, you&#39;ll see a <code>query</code> option appear at the bottom. This will allow us to query this connection in an SQL cell, however, what we want to do is create a Snowpark session using this connection. Click on the dropdown next to the <code>query</code> button and select <code>Get Snowpark session</code>. What this will do is create a new cell for us with all the code needed to spin up a Snowpark session.</p>
<p><em>The cell created by this button will be positioned under the cell that is currently selected. It is best practice to have this new cell be placed right below package import cell.</em></p>
<p class="image-container"><img src="img/756e6cdd71876139.png"></p>
<p>Scope the Snowpark session to the appropriate database and schema. If you are using a different database and schema name, please ensure to scope the Snowpark session to the correct database and schema.</p>
<pre><code language="language-python" class="language-python">session.use_database(&#39;PC_HEX_DB&#39;)
session.use_schema(&#34;PC_HEX_DB.PUBLIC&#34;)
</code></pre>
<p>In this cell, we reference our Snowpark session with the variable <code>session</code> which is the name assigned by default. Your cells should look similar to this:</p>
<p class="image-container"><img src="img/f8657076c2452541.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Hex Project" duration="45">
        <p>The rest of the lab can entirely be followed step-by-step from the Hex project. Any subsequent steps and explanation will be found in the Hex project itself.</p>
<p>Key sections of the Hex project include:</p>
<ul>
<li>Getting Started</li>
<li>Data Exploration</li>
<li>Preprocessing and Feature Engineering</li>
<li>Model Training</li>
<li>Registry</li>
<li>Model Inference via a Hex app</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Sharing our results" duration="3">
        <p>Now that we&#39;ve completed going through our project, we can share this project with others! To do this:</p>
<ul>
<li>Head over to the app builder</li>
<li>A pre-built layout has been designed but feel free to customize and add any additional elements</li>
<li>To customize add, remove, and arrange cells. Check out the <a href="https://learn.hex.tech/docs/build-apps/app-builder" target="_blank">Hex docs</a> for more info.</li>
<li>Publish the app with the <a href="https://learn.hex.tech/docs/share-insights/apps/publish-and-share-apps" target="_blank">Publish button</a></li>
<li>Lastly, hit the share button next to publish, and select <code>Publish to web</code>.</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Conclusion and Resources" duration="0">
        <p>Congratulations on making it to the end of this Lab! You&#39;ve successfully perform feature engineering, trained an XGBoost model to predict the probably of survival onboard the Titanic, and logged that model to Snowflake&#39;s Model Registy. At the end, you created a Hex app that allowed users to pass in their own criteria to see if they would survive the Titanic.</p>
<h2 is-upgraded>What You Learned</h2>
<ul>
<li>How to perform preprocessing with Snowpark ML</li>
<li>How to perform model training with Snowpark ML</li>
<li>How to register the model in Snowflakes Registry</li>
<li>How models are &#34;deployed&#34; in Snowflake</li>
<li>How to perform inference using Snowpark and SQL against the registered model</li>
<li>How to create your own Hex app and share it out to end users</li>
</ul>
<h2 is-upgraded>Related Resources</h2>
<ul>
<li><a href="https://app.hex.tech/810c3d49-47a5-470c-9eaa-f471548c9620/app/af138a51-cae9-4300-9aee-6805afe6e699/latest" target="_blank">Final Project</a></li>
<li><a href="https://developers.snowflake.com/solution/data-exploration-with-hex-and-snowpark/" target="_blank">Data Exploration &amp; Analysis using Hex and Snowpark</a></li>
<li><a href="https://developers.snowflake.com/solution/time-series-forecasting-using-snowpark-and-hex/" target="_blank">Parallelized Time Series Forecasting Of Restaurant Foot Traffic Using Snowpark UDTF</a></li>
<li><a href="https://developers.snowflake.com/solution/optimizing-marketing-budget-using-snowpark-ml-in-hex-notebooks/" target="_blank">How To Leverage Libraries Outside of Snowpark ML</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/native-shim.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/custom-elements.min.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/prettify.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("2025084205");
  </script>
</body>
</html>
