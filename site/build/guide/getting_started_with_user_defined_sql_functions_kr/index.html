
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>사용자 정의 SQL 함수 시작하기</title>

  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5Q8R2G');</script>
  

  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-08H27EW14N"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-08H27EW14N');
</script>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5Q8R2G"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <google-codelab-analytics gaid="UA-41491190-9"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="getting_started_with_user_defined_sql_functions_kr"
                  title="사용자 정의 SQL 함수 시작하기"
                  environment="web"
                  feedback-link="https://github.com/Snowflake-Labs/devlabs/issues">
    
      <google-codelab-step label="개요" duration="3">
        <p>UDF(사용자 정의 함수)로 시스템을 확장하면, Snowflake에서 제공하는 내장 시스템 정의 함수를 통해 제공되지 않는 작업을 수행할 수 있습니다.</p>
<h3 is-upgraded>Snowflake는 현재 UDF 작성을 위해 다음 언어를 지원합니다.</h3>
<ul>
<li><strong>SQL</strong>: SQL UDF는 임의 SQL 식을 평가하며 스칼라 또는 테이블 형식 결과를 반환합니다.</li>
<li><strong>JavaScript</strong>: JavaScript UDF를 통해 JavaScript 프로그래밍 언어를 사용하여 데이터를 조작하고 스칼라 또는 테이블 형식 결과를 반환할 수 있습니다.</li>
<li><strong>Java</strong>: Java UDF를 통해 Java 프로그래밍 언어를 사용하여 데이터를 조작하고 스칼라 결과를 반환할 수 있습니다.</li>
</ul>
<h3 is-upgraded>이 가이드는 Snowflake 설정 과정을 안내하며 여러분이 다음에 익숙해질 수 있도록 합니다</h3>
<ul>
<li><strong>SQL</strong> UDF(사용자 정의 함수) 생성 및 실행</li>
<li><strong>SQL</strong> UDTF(사용자 정의 테이블 함수) 생성 및 실행.</li>
</ul>
<h2 is-upgraded>사전 필요 조건 및 지식</h2>
<p>Snowflake 사용자 인터페이스에 익숙하지 않다면 아래 동영상을 시청하십시오.</p>
<ul>
<li>짧은 <a href="https://www.youtube.com/watch?v=fEtoYweBNQ4&ab_channel=SnowflakeInc." target="_blank">Snowflake 소개</a> 동영상</li>
</ul>
<h2 is-upgraded>학습할 내용</h2>
<ul>
<li>Snowflake 계정 및 사용자 권한</li>
<li>데이터베이스 오브젝트 생성</li>
<li>사용자 정의 스칼라 함수 쿼리</li>
<li>사용자 정의 테이블 함수 쿼리</li>
<li>데이터베이스 오브젝트 삭제</li>
</ul>
<h2 is-upgraded>필요한 것</h2>
<ul>
<li><a href="https://signup.snowflake.com/?utm_cta=quickstarts_" target="_blank">Snowflake</a> 평가판 계정</li>
</ul>
<h2 is-upgraded>구축할 것</h2>
<ul>
<li>오브젝트 쿼리를 위한 데이터베이스 오브젝트 및 사용자 정의 함수.</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="기본 사항부터 시작하기" duration="3">
        <h3 is-upgraded>우선 여러분의 Snowflake 계정을 생성하고 사용자 권한을 관리하는 방법을 다루겠습니다.</h3>
<h2 is-upgraded>Snowflake 계정 생성</h2>
<p>Snowflake는 무료로 Snowflake 서비스를 이용해 볼 수 있도록 <a href="https://signup.snowflake.com/?utm_cta=quickstarts_" target="_blank">평가판 계정</a>을 제공합니다. 프롬프트에 따라 이메일로 계정을 활성화합니다.</p>
<p>Snowflake 계정이 이미 있다면 이를 사용할 수 있습니다.  데이터베이스 생성 권한을 가진 역할만 있으면 됩니다.</p>
<h2 is-upgraded>Snowflake의 웹 콘솔 액세스</h2>
<pre><code>https://&lt;your-account-name&gt;.snowflakecomputing.com/console/login
</code></pre>
<p>브라우저에서 <a href="https://docs.snowflake.com/ko/user-guide/connecting.html#logging-in-using-the-web-interface" target="_blank">웹 인터페이스</a>에 로그인합니다. URL은 여러분의 <a href="https://docs.snowflake.com/ko/user-guide/connecting.html#your-snowflake-account-name" target="_blank">계정 이름</a>과 잠재적으로 지역을 포함합니다.</p>
<h2 is-upgraded>역할 변경</h2>
<p>Positive : Snowflake 계정이 이미 있다면 데이터베이스 생성 권한을 가진 역할을 사용할 수 있습니다.</p>
<p class="image-container"><img alt="Snowflake_SwitchRole_DemoUser-image" src="img/3270a18bbdd22d31.png"></p>
<p>기본값인 <code>SYSADMIN</code>에서 <code>ACCOUNTADMIN</code>으로 계정 역할을 전환합니다. <strong>필수는 아니지만</strong>, 이 랩의 스크린샷과 웹 UI가 일치하게 만들어 줍니다.</p>
<p>새로운 계정을 생성하고 역할을 구성했으니 다음 섹션에서 데이터베이스 오브젝트 생성을 시작할 준비가 되었습니다.</p>


      </google-codelab-step>
    
      <google-codelab-step label="데이터베이스 오브젝트 생성" duration="5">
        <p>Snowflake 계정에 쉽게 접근할 수 있으니 데이터베이스 오브젝트를 생성할 시간입니다.</p>
<p>Snowflake 웹 콘솔 내에서 <strong>Worksheets</strong>로 이동한 다음 새로운 워크시트를 사용하여 다음 명령을 실행합니다.</p>
<h2 is-upgraded>1. 새로운 데이터베이스 생성</h2>
<pre><code language="language-sql" class="language-sql">create or replace database udf_db;
</code></pre>
<p>위 명령으로 <code>udf_db</code>라는 새로운 데이터베이스를 구축합니다.</p>
<p class="image-container"><img alt="Snowflake_udf_CreateDB-image" src="img/30d7feb23924bd9b.png"></p>
<p>Positive : <strong>Results</strong>는 <strong>Database UDF_DB successfully created</strong>라는 상태 메시지를 표시해야 합니다.</p>
<h2 is-upgraded>2. 새로운 스키마 생성</h2>
<pre><code language="language-sql" class="language-sql">create schema if not exists udf_schema_public;
</code></pre>
<p>위 명령을 사용하여 <code>udf_schema_public</code>이라는 스키마를 생성합니다.</p>
<p class="image-container"><img alt="Snowflake_udf_CreateSchema-image" src="img/ec83a0eafe59a8a8.png"></p>
<p>Positive : <strong>Results</strong>는 <strong>Schema UDF_SCHEMA_PUBLIC successfully created</strong>라는 상태 메시지를 표시해야 합니다.</p>
<h2 is-upgraded>3. 새로운 테이블에 샘플 데이터 복사</h2>
<pre><code language="language-sql" class="language-sql">create or replace table udf_db.udf_schema_public.sales 
  as
    (select * from snowflake_sample_data.tpcds_sf10tcl.store_sales sample block (1));

</code></pre>
<p>‘sales&#39;라는 테이블을 생성하고 이 명령으로 매출 데이터를 가져옵니다. 샘플 데이터를 가져오는 데 이전 단계에서 보다 더 긴 실행 시간이 소요될 것입니다.</p>
<p class="image-container"><img alt="Snowflake_udf_CreateTable-image" src="img/f49a2b0ccc443f63.png"></p>
<p>Positive : <strong>Results</strong>는 <strong>Table SALES successfully created</strong>라는 상태 메시지를 표시해야 합니다.</p>
<p>필요한 데이터베이스 오브젝트가 생성되었으니 다음 섹션에서 UDF로 작업하는 메인 수업으로 이동할 시간입니다.</p>


      </google-codelab-step>
    
      <google-codelab-step label="스칼라 사용자 정의 함수 실행" duration="6">
        <p>샘플 매출 데이터가 포함된 데이터베이스가 있으니 스칼라 UDF 생성을 시도할 준비가 <em>거의</em> 끝났습니다. 시작하기 전에 우선 UDF 명명 규칙에 대해 더 자세히 이해해 보겠습니다.</p>
<p>Negative : 함수 이름이 데이터베이스와 스키마(예: <code>udf_db.udf_schema_public.udf_name</code>)를 지정하지 않는다면 기본값으로 활성 세션이 됩니다. UDF는 데이터베이스 오브젝트이기에 자체적인 <a href="https://docs.snowflake.com/ko/sql-reference/udf-overview.html#naming-conventions-for-udfs" target="_blank">명명 규칙</a>을 따르는 것이 더 낫습니다. 빠른 연습을 위해 활성 세션에 의존하겠습니다.</p>
<h2 is-upgraded>1. UDF 생성</h2>
<pre><code language="language-sql" class="language-sql">create function udf_max()
  returns NUMBER(7,2)
  as
  $$
    select max(SS_LIST_PRICE) from udf_db.udf_schema_public.sales
  $$
  ;
</code></pre>
<p><a href="https://docs.snowflake.com/ko/sql-reference/functions/min.html#min-max" target="_blank">SQL 함수</a> <code>max</code>는 <code>SS_LIST_PRICE</code> 열에서 가장 높은 값을 반환합니다.</p>
<p class="image-container"><img alt="Snowflake_udf_max-image" src="img/b23a48ddc8e44e66.png"></p>
<p>이미지는 <code>udf_max</code> 함수의 성공적인 생성을 보여 줍니다.</p>
<h2 is-upgraded>2. UDF 호출</h2>
<pre><code language="language-sql" class="language-sql">select udf_max();
</code></pre>
<p><a href="https://docs.snowflake.com/ko/sql-reference/sql/select.html" target="_blank">SQL 명령</a> <code>select</code>로 새로운 UDF를 호출합니다.</p>
<p class="image-container"><img alt="Snowflake_select_udf_max-image" src="img/db1daf03c716803.png"></p>
<p>위 이미지는 반환된 <strong>Results</strong>입니다.</p>
<p>이제 UDF 생성의 기본 사항을 연습했으니 새로운 테이블을 반환하는 UDF를 생성하여 다음 섹션에서 한 단계 더 어려운 작업을 시작하겠습니다.</p>


      </google-codelab-step>
    
      <google-codelab-step label="사용자 정의 테이블 함수로 쿼리" duration="6">
        <p>성공적인 스칼라 UDF를 생성한 후 UDTF(사용자 정의 테이블 함수)로 테이블을 반환하는 함수를 만들어 보겠습니다.</p>
<h2 is-upgraded>1. UDTF 생성</h2>
<pre><code language="language-sql" class="language-sql">create or replace function
udf_db.udf_schema_public.get_market_basket(input_item_sk number(38))
returns table (input_item NUMBER(38,0), basket_item_sk NUMBER(38,0),
num_baskets NUMBER(38,0))
as
 &#39;select input_item_sk, ss_item_sk basket_Item, count(distinct
ss_ticket_number) baskets
from udf_db.udf_schema_public.sales
where ss_ticket_number in (select ss_ticket_number from udf_db.udf_schema_public.sales where ss_item_sk = input_item_sk)
group by ss_item_sk
order by 3 desc, 2&#39;;
</code></pre>
<p>위 코드 조각은 시장바구니 분석을 포함한 테이블을 반환하는 함수를 생성합니다.</p>
<p class="image-container"><img alt="Snowflake_udtf-image" src="img/75016e869fe40231.png"></p>
<h2 is-upgraded>2. UDTF 실행</h2>
<pre><code language="language-sql" class="language-sql">select * from table(udf_db.udf_schema_public.get_market_basket(6139));
</code></pre>
<p>스칼라 UDF와 같이 이는 여러분의 함수를 실행합니다.</p>
<p class="image-container"><img alt="Snowflake_select_udtf-image" src="img/553d22dc0d8625ab.png"></p>
<p>반환된 것은 샘플 매출 데이터를 기반으로 한 시장바구니 분석 테이블입니다.</p>
<p>여러분은 UDTF를 만드는 것을 연습했으며 UDF에 익숙해졌습니다. 마지막 섹션에서는 필요 없는 데이터베이스 오브젝트를 삭제하겠습니다.</p>


      </google-codelab-step>
    
      <google-codelab-step label="정리" duration="2">
        <p>많은 내용을 다뤘습니다! 마무리하기 전에 이 가이드에서 생성했던 연습 데이터베이스를 삭제하십시오. 이는 생성했던 데이터베이스와 모든 테이블 및 함수를 삭제합니다.</p>
<h2 is-upgraded>1. 데이터베이스 삭제</h2>
<p>데이터베이스 삭제: <code>udf_db</code>.</p>
<pre><code language="language-sql" class="language-sql">drop database if exists udf_db;
</code></pre>
<p class="image-container"><img alt="Snowflake_udf_DropDB-image" src="img/318932cf6b70d7d6.png"></p>
<p><code>UDF_DB successfully dropped</code>의 <strong>Results</strong>를 확인하여 데이터베이스가 완전히 삭제되었는지 확인합니다.</p>


      </google-codelab-step>
    
      <google-codelab-step label="종료 및 다음 단계" duration="2">
        <p>스칼라와 테이블 함수를 모두 연습했기에 이제 SQL UDF를 잘 다룰 수 있을 것입니다. 데이터베이스 오브젝트를 끝냈으니 앞으로의 단계를 살펴볼 시간입니다.</p>
<p>공유 가능하고 <a href="https://docs.snowflake.com/ko/sql-reference/udf-secure.html#secure-udfs" target="_blank">안전한</a> 사용자 정의 함수의 잠재력을 고려하십시오. <a href="https://www.snowflake.com/blog/the-power-of-secure-user-defined-functions-for-protecting-shared-data/" target="_blank">안전한 UDF의 위력</a>에 대한 이 게시물에서 시장바구니 분석 테이블과 같은 사용자 정의 함수를 공유하는 방법을 배울 수 있습니다.</p>
<h2 is-upgraded>다룬 내용</h2>
<ul>
<li>Snowflake 계정 등록</li>
<li>역할 권한 구성</li>
<li>데이터베이스 및 기타 오브젝트 생성</li>
<li>UDTF로 데이터를 분석하기 위한 테이블 생성</li>
<li>사용자 지정 UDF 쿼리</li>
<li>모든 오브젝트를 정리하기 위해 데이터베이스 삭제</li>
</ul>
<h2 is-upgraded>관련 리소스</h2>
<p>UDF에 대한 더 많은 정보:</p>
<ul>
<li><a href="https://docs.snowflake.com/ko/developer-guide/udf/sql/udf-sql.html#sql-udfs" target="_blank">SQL UDF</a></li>
<li><a href="https://docs.snowflake.com/ko/developer-guide/udf/javascript/udf-javascript.html#javascript-udfs" target="_blank">JavaScript UDF</a></li>
<li><a href="https://docs.snowflake.com/ko/developer-guide/udf/java/udf-java.html#java-udfs" target="_blank">Java UDF</a></li>
</ul>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/native-shim.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/custom-elements.min.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/prettify.js"></script>
  <script src="https://quickstarts.snowflake.com/elements/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>
  <script type="text/javascript">
    window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
    heap.load("2025084205");
  </script>
</body>
</html>
